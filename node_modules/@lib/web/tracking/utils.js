var extend = require('extend'),
    utils = {};

utils.getSession = function (visitor, context) {
    var session = {};

    if (!visitor || !visitor.session || !Object.keys(visitor.session).length) {
        session['is_new'] = '1';
    } else if (visitor.session['timeout'] >= Number(context['now'])) {
        extend(session, visitor.session);
        session['is_new'] = '0';
    } else {
        session['is_new'] = '1';
    }

    return session;
};

module.exports = utils;
