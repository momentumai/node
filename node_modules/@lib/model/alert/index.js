var path = require('path'),
    db = require('@lib/resources/db'),
    sqlUtils = require('@lib/utils/sql'),
    q = sqlUtils.getQueries(path.join(__dirname, 'sql')),
    alert = {};

alert.list = function (teamId, cats, lastStart, pool) {
    var params = {};

    params.team_id = teamId;
    params.last_start = Number(lastStart) || '0';
    params.cats = cats;

    return db.q(q['list'], params, pool).then(function (rows) {
        var resp = {};

        if (rows.length) {
            resp.last = rows[0].timestamp;
            resp.cId = rows[0].content_id;
        }

        return resp;
    });
};

module.exports = alert;
