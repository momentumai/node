SELECT
    campaign.id,
    campaign.content_id,
    campaign.adset_id,
    campaign.seed,
    campaign.viral,
    campaign.created_at,
    campaign.meta
FROM
    campaign
RIGHT JOIN
    team_user_fb_asset as a
ON
    a.team_id = {{team_id}} AND
    a.user_id = {{user_id}} AND
    a.`type` = 2 AND
    a.`value` = campaign.adaccount
WHERE
    {{#if filter }}
        (
            campaign.created_at BETWEEN {{filter.from}} AND {{filter.to}} OR
            campaign.end_time BETWEEN {{filter.from}} AND {{filter.to}}
        ) AND
    {{/if}}
    {{#if content_id}}
        campaign.content_id = '{{content_id}}' AND
    {{else}}
        {{#each cats}}
            {{#if .}}
                campaign.cat{{inc @index}} = '{{.}}' AND
            {{/if}}
        {{/each}}
    {{/if}}
    campaign.team_id = {{team_id}} AND
    campaign.finished = 1
ORDER BY campaign.created_at DESC
{{#if limit}}
    LIMIT {{limit}}
    OFFSET {{offset}}
{{/if}}
;
