var ds = require('@lib/resources/datastore'),
    publicInfo = require('@lib/model/content/public-info'),
    info = {};

info.get = function (teamId, contentId) {
    var url = '';

    return ds.init(teamId).then(function (datastore) {
        var query = datastore.createQuery('Content');

        query.filter('content_id', contentId);

        return ds.runQuery(query, datastore).then(function (results) {
            url = results[0].key.name;
            return publicInfo.get(teamId, url);
        });
    }).then(function (ogdata) {
        ogdata.url = url;

        ogdata.title = ogdata.title || ogdata.url;
        ogdata.site_name = ogdata.site_name || '';
        ogdata.image = ogdata.image || '';
        ogdata.description = ogdata.description || '';

        return ogdata;
    });
};

module.exports = info;
